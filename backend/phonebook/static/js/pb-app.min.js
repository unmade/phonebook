!function(){"use strict";angular.module("pbApp",["ngRoute","ngResource","ngMaterial","infinite-scroll","pbApp.routes","pbApp.employees","pbApp.companies","pbApp.feedback"]),angular.module("pbApp.routes",[])}();
!function(){"use strict";angular.module("pbApp.companies",["pbApp.companies.services"]),angular.module("pbApp.companies.services",["ngResource"])}();
!function(){"use strict";angular.module("pbApp.employees",["pbApp.employees.controllers","pbApp.employees.services","pbApp.employees.directives"]),angular.module("pbApp.employees.controllers",[]),angular.module("pbApp.employees.directives",[]),angular.module("pbApp.employees.services",["ngResource"])}();
!function(){"use strict";angular.module("pbApp.feedback",["ngResource"])}();
!function(){"use strict";angular.module("pbApp").config(["$resourceProvider",function(e){e.defaults.stripTrailingSlashes=!1}]).config(["$httpProvider",function(e){e.defaults.xsrfCookieName="csrftoken",e.defaults.xsrfHeaderName="X-CSRFToken"}])}();
!function(){"use strict";function e(){return function(e){function c(e){return 4==e.length?e.slice(0,2)+"-"+e.slice(2):7==e.length?e.slice(0,3)+"-"+e.slice(3,5)+"-"+e.slice(5,7):e}if(!e)return"";var r,i,t,s=e.toString().replace(/[()-\s]+/g,"");switch(s.length){case 4:case 7:return c(s);case 10:r="",i=s.slice(0,3),t=c(s.slice(3));break;case 11:r=s[0],i=s.slice(1,4),t=c(s.slice(4));break;case 12:r=s.slice(0,2),i=s.slice(2,5),t=c(s.slice(5));break;default:return e}return(r+" ("+i+") "+t).trim()}}angular.module("pbApp").filter("formatPhone",e)}();
!function(){"use strict";function e(e){e.when("/employees",{templateUrl:"/static/partials/employees/employee-list.html",controller:"EmployeeListCtrl",controllerAs:"ctrl"}).when("/feedback",{templateUrl:"/static/partials/feedbacks.html",controller:"FeedbackListCtrl",controllerAs:"ctrl"}).otherwise({redirectTo:"/employees"})}angular.module("pbApp.routes").config(e),e.$inject=["$routeProvider"]}();
!function(){"use strict";function r(r){return r("api/companies/company/:id",{},{query:{method:"GET",isArray:!1}})}function e(r){return r("api/companies/center/:id",{},{query:{method:"GET",isArray:!1}})}function i(r){return r("api/companies/division/:id",{},{query:{method:"GET",isArray:!1}})}angular.module("pbApp.companies.services").factory("Company",["$resource",r]).factory("Center",["$resource",e]).factory("Division",["$resource",i])}();
!function(){"use strict";function e(e,n,l,t,o,s,i,c){function r(e,n){function t(e,n){e.employee=n,e.hide=function(){l.hide()},e.cancel=function(){l.cancel()},e.answer=function(e){l.hide(e)}}n&&l.show({controller:["$scope","employee",t],templateUrl:"employee-detail.dialog.tmpl.html",parent:angular.element(document.body),locals:{employee:n},targetEvent:e,clickOutsideToClose:!0})}function a(e){var l=4;if(!e)return v.employees.results.slice(0,l);var o=n.defer();return t.query({search:e,limit:l,offset:0},function(e,n){o.resolve(e.results)}),o.promise}function u(e){v.selectedCompany=null,v.selectedCenter=null,v.selectedDivision=null,v.employees=new o({search:e}),v.employees.nextPage()}function m(){return v.companies||s.query(function(e){v.companies=e})}function p(){return v.centers&&v.centers.results.length&&v.centers.results[0].company==v.selectedCompany?void 0:i.query({company:v.selectedCompany},function(e){v.centers=e})}function d(){return v.divisions&&v.divisions.results.length&&v.divisions.results[0].center==v.selectedCenter?void 0:c.query({center:v.selectedCenter},function(e){v.divisions=e})}function y(){v.selectedCenter=null,v.selectedDivision=null,v.employees=new o({company:v.selectedCompany,search:v.searchText||null}),v.employees.nextPage()}function f(){v.selectedDivision=null,v.employees=new o({company:v.selectedCompany,center:v.selectedCenter,search:v.searchText||null}),v.employees.nextPage()}function C(){v.employees=new o({company:v.selectedCompany,center:v.selectedCenter,division:v.selectedDivision,search:v.searchText||null}),v.employees.nextPage()}function h(e){return e.surname+" "+e.firstname+" "+e.patronymic}var v=this;v.employees=new o,v.companies=null,v.centers=null,v.divisions=null,v.selectedCompany=null,v.selectedCenter=null,v.selectedDivision=null,v.employeeSearch=a,v.getEmployeeName=h,v.loadCompanies=m,v.loadCenters=p,v.loadDivisions=d,v.search=u,v.companyChanged=y,v.centerChanged=f,v.divisionChanged=C,v.showEmployeeDetail=r}angular.module("pbApp.employees.controllers").controller("EmployeeListCtrl",["$scope","$q","$mdDialog","Employee","EmployeeScroll","Company","Center","Division",e])}();
!function(){"use strict";function t(t){return t("api/employees/employee/:id",{},{query:{method:"GET",isArray:!1}})}function s(t){var s=function(t){this.results=[],this.after=void 0,this.params=angular.copy(t)||{},this.params.offset=0,this.params.limit=20,this.busy=!1};return s.prototype.nextPage=function(){this.busy||null!==this.after&&(this.busy=!0,t.query(this.params,function(t){this.results=this.results.concat(t.results),this.params.offset+=this.params.limit,this.after=t.next,this.busy=!1}.bind(this)))},s}angular.module("pbApp.employees.services").factory("Employee",["$resource",t]).factory("EmployeeScroll",["Employee",s])}();
!function(){"use strict";function e(){return function(e){switch(e){case"DF":return"";case"PR":return"В процессе";case"NW":return"Новое";case"SL":return"Выполнено";case"RJ":return"Не будет выполнено";default:return""}}}angular.module("pbApp.feedback").filter("getStatusName",e)}();
!function(){"use strict";function e(e){return e("api/feedback/feedback/",{},{query:{method:"GET",isArray:!1}})}angular.module("pbApp.feedback").factory("feedbackService",e),e.$inject=["$resource"]}();
!function(){"use strict";function e(e,t,i){function o(t){e.show({templateUrl:"new-feedback-dialog.tmpl.html",targetEvent:t,clickOutsideToClose:!0,controller:c,controllerAs:"dialog"})}function c(){function t(){e.hide(),i.query({limit:50,offset:0},function(e){l.feedbacks=e})}var o=this;o.hide=t}var l=this;l.feedbacks=i.query({limit:50,offset:0}),l.showNewFeedbackDialog=o}angular.module("pbApp.feedback").controller("FeedbackListCtrl",e),e.$inject=["$mdDialog","$mdToast","feedbackService"]}();
!function(){"use strict";function e(){return{bindToController:!0,controller:t,controllerAs:"newFeedback",replace:!0,restrict:"AE",scope:{onSend:"&"},templateUrl:"new-feedback.directive.html"}}function t(e,t,o,n){function s(){r.sender&&r.text&&n.save({sender:r.sender,text:r.text},function(e){r.status="",r.onSend&&r.onSend(),r.showSuccessToast()},function(e){r.status="Error",r.showFailedToast()})}function i(){o.show(o.simple().textContent("Ваше сообщение принято!").position("top right").hideDelay(3e3))}function c(){o.show(o.simple().textContent("Отправка не удалась!").position("top right").hideDelay(3e3))}var r=this;r.add=s,r.showSuccessToast=i,r.showFailedToast=c}angular.module("pbApp.feedback").directive("newFeedback",e),t.$inject=["$scope","$mdDialog","$mdToast","feedbackService"]}();
!function(){"use strict";function e(){return{restrict:"AE",templateUrl:"employees/directives/templates/employee-detail.html",scope:{employee:"=employee"}}}angular.module("pbApp.employees.directives").directive("employeeDetail",e)}();
!function(){"use strict";function e(){return{restrict:"AE",templateUrl:"employees/directives/templates/employee-list-item.html",scope:{employee:"=employee"}}}angular.module("pbApp.employees.directives").directive("employeeListItem",e)}();
angular.module("pbApp.feedback").run(["$templateCache",function(e){e.put("new-feedback.directive.html",'<form name="newFeedbackForm" layout="column" layout-padding style="min-width:640px;min-height:480px;">\n    <md-input-container class="md-block">\n        <label>Представьтесь</label>\n        <input ng-model="newFeedback.sender"\n               name="sender"\n               md-maxlength="50"\n               required\n               autofocus="true">\n        <div ng-messages="NewFeedbackForm.sender.$error">\n            <div ng-message="required">Необходимо указать <b>своё</b> ФИО.</div>\n            <div ng-message="md-maxlength">Убедитесь, что в этом поле не больше 50 символов</div>\n        </div>\n    </md-input-container>\n\n    <md-input-container class="md-block" flex>\n        <label>Текст</label>\n        <textarea ng-model="newFeedback.text"\n                  columns="1"\n                  md-maxlength="500"\n                  rows="6"\n                  name="text"\n                  required>\n        </textarea>\n        <div ng-messages="NewFeedbackForm.text.$error">\n            <div ng-message="required">Поле не может быть пустым!</div>\n            <div ng-message="md-maxlength">Убедитесь, что в этом поле не больше 500 символов</div>\n        </div>\n    </md-input-container>\n    <div layout="row">\n        <span flex></span>\n        <md-button ng-click="newFeedback.add()"\n                   ng-disabled="!(newFeedback.sender && newFeedback.text)"\n                   class="md-fab md-primary md-mini"\n                   aria-label="Sent">\n            <md-icon>send</md-icon>\n        </md-button>\n    </div>\n</form>\n')}]);